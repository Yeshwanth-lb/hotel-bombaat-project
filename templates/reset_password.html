{% extends "base.html" %}
{% block content %}
<div class="form-container">
    <form class="card-form" method="POST" action="{{ url_for('auth.reset_password_token', token=token) }}" style="max-width: 450px;">
        <div style="text-align: center; margin-bottom: 2rem;">
            <div style="width: 80px; height: 80px; margin: 0 auto 1rem; background: linear-gradient(135deg, var(--success-color), #20c997); border-radius: 50%; display: flex; align-items: center; justify-content: center;">
                <i class="fa-solid fa-lock-open" style="font-size: 2rem; color: white;"></i>
            </div>
            <h2 style="margin-bottom: 0.5rem;">Set New Password</h2>
            <p style="color: #666; margin: 0;">Create a strong password ಹೊಸ ಪಾಸ್‌ವರ್ಡ್ (New Password)</p>
        </div>
        
        <div style="background: #d1ecf1; border-left: 4px solid var(--info-color); padding: 1rem; margin-bottom: 1.5rem; border-radius: 8px;">
            <p style="margin: 0; font-size: 0.9rem; color: #0c5460;">
                <i class="fa-solid fa-lightbulb"></i>
                <strong>Password Tips:</strong> Use a mix of letters, numbers, and symbols for better security.
            </p>
        </div>
        
        <div class="form-group">
            <label for="password"><i class="fa-solid fa-lock"></i> New Password</label>
            <input type="password" id="password" name="password" placeholder="Enter new password" required minlength="6">
            <small style="color: #666; font-size: 0.85rem; display: block; margin-top: 0.25rem;">
                <i class="fa-solid fa-info-circle"></i> Minimum 6 characters
            </small>
        </div>
        
        <div class="form-group">
            <label for="confirm_password"><i class="fa-solid fa-lock"></i> Confirm New Password</label>
            <input type="password" id="confirm_password" name="confirm_password" placeholder="Re-enter new password" required minlength="6">
        </div>
        
        <div id="password-match-indicator" style="margin-top: 0.5rem; padding: 0.5rem; border-radius: 5px; display: none;">
            <small id="match-text"></small>
        </div>
        
        <button type="submit" class="btn btn-primary" id="submit-btn" style="width: 100%; padding: 0.9rem;">
            <i class="fa-solid fa-check"></i> Reset Password
        </button>
        
        <div class="form-switch" style="margin-top: 2rem; text-align: center; padding-top: 1.5rem; border-top: 1px solid #eee;">
            <p style="margin: 0; color: #666;">
                <a href="{{ url_for('auth.login') }}" style="color: var(--primary-color); font-weight: 500;">
                    <i class="fa-solid fa-arrow-left"></i> Back to Login
                </a>
            </p>
        </div>
    </form>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const password = document.getElementById('password');
    const confirmPassword = document.getElementById('confirm_password');
    const indicator = document.getElementById('password-match-indicator');
    const matchText = document.getElementById('match-text');
    const submitBtn = document.getElementById('submit-btn');
    
    function checkPasswordMatch() {
        if (confirmPassword.value === '') {
            indicator.style.display = 'none';
            return;
        }
        
        indicator.style.display = 'block';
        
        if (password.value === confirmPassword.value) {
            indicator.style.background = '#d4edda';
            indicator.style.border = '1px solid #c3e6cb';
            matchText.style.color = '#155724';
            matchText.innerHTML = '<i class="fa-solid fa-check-circle"></i> Passwords match!';
            submitBtn.disabled = false;
        } else {
            indicator.style.background = '#f8d7da';
            indicator.style.border = '1px solid #f5c6cb';
            matchText.style.color = '#721c24';
            matchText.innerHTML = '<i class="fa-solid fa-times-circle"></i> Passwords do not match';
            submitBtn.disabled = true;
        }
    }
    
    password.addEventListener('input', checkPasswordMatch);
    confirmPassword.addEventListener('input', checkPasswordMatch);
});
</script>
{% endblock %}